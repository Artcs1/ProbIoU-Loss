<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="descripction"
        content="Probabilistic intersection-over-union for training and evaluation of oriented object detectors">
  <meta name="keywords" content="Object Detection,Oriented Object Detectors,Normal Distribution,Loss Function,Bounding Box,Local Loss,Nature Of Representations,Regression Loss, Hellinger Distance, Circular Objects,Elliptical Region,Additional Hyperparameter,Covariance Matrix,Probability Density Function,Detection Results,Aerial Images,Triangle Inequality,Storage Tank,Optical Character Recognition,Ground Truth Annotations,Intersection Over Union Value,Straightforward Implementation,Local Terms,Bhattacharyya Distance,Categories In Dataset,Intersection Over Union Threshold,Tennis Court,Angular Information,Roundabout">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Probabilistic intersection-over-union for training and evaluation of oriented object detectors</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
    <meta charset="UTF-8">
  <title>Converted LaTeX to HTML</title>

  <!-- MathJax -->
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    table {
      border-collapse: collapse;
      width: 100%;
      font-size: 0.85em;
    }
    th, td {
      border: 1px solid #000;
      padding: 6px;
      text-align: center;
    }
    .fixed-height-img {
      height: 220px;          /* choose the height you want */
      width: 100%;
    }
  </style>
  
</head>
<body>

<!-- <nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://keunhong.com">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a> -->

<!--       <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://hypernerf.github.io">
            HyperNeRF
          </a>
          <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a>
        </div>
      </div> -->
<!--     </div>

  </div>
</nav> -->


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Probabilistic intersection-over-union for training and evaluation of oriented object detectors</h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a href="https://artcs1.github.io/">Jeffri Murrugarra-Llerena</a>,</span>
              <span class="author-block">
                <a href="https://www.linkedin.com/in/haoran-niu-b4b3b6114/">Lucas N. Kirsten</a>,</span>
              <span class="author-block">
                <a href="https://www.ece.utexas.edu/people/faculty/suzanne-barber">Luis Felipe Zeni</a>,
              </span>
              <span class="author-block">
                <a href="https://users.umiacs.umd.edu/~hal3//">Claudio R. Jung</a>,
              </span>
            </div>

            <div class="is-size-5 publication-authors">
                <span class="author-block">Federal University of Rio Grande do Sul</span>
            </div>
            <div class="is-size-5 publication-authors">
                <span class="author-block">
                Transactions on Image Processing (IEEE TIP) 2024</span>
            </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2106.06072"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Code Link. -->

              <span class="link-block">
                <a href="https://github.com/ProbIOU/probiou-sample"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code: Sample</span>
                  </a>
              </span>
              
              <span class="link-block">
                <a href="https://github.com/open-mmlab/mmrotate"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code: MMRotate</span>
                  </a>
              </span>
            


              
              <!-- Dataset Link. -->
              <!-- <span class="link-block">
                 <a href="https://github.com/robingg1/PoseTraj"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a>
              </span> -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <h2 class="title is-3">Comparison with other methods</h2>
      
      <!-- 第二排 -->
      <div class="columns is-multiline is-centered">
        <div class="column">
          <img class="fixed-height-img" src="./static/images/img_333_l1_obb.png" alt="Image">
        </div>
        <div class="column">
          <img class="fixed-height-img" src="./static/images/100000645_l1_obb.png" alt="Gemini">
        </div>
        <div class="column">
          <img class="fixed-height-img" src="./static/images/plane_P0963_l1_obb.png" alt="GPT4">
        </div>
        <div class="column">
          <img class="fixed-height-img" src="./static/images/P2032_l1_obb.jpg" alt="MistralOCR">
        </div>
      </div>

      
      <!-- 第二排 -->
      <div class="columns is-multiline is-centered">
        <div class="column">
          <img class="fixed-height-img" src="./static/images/img_333_gwd_obb.png" alt="Image">
        </div>
        <div class="column">
          <img class="fixed-height-img" src="./static/images/100000645_gwd_obb.png" alt="Gemini">
        </div>
        <div class="column">
          <img class="fixed-height-img" src="./static/images/plane_P0963_gwd_obb.png" alt="GPT4">
        </div>
        <div class="column">
          <img class="fixed-height-img" src="./static/images/P2032_gwd_obb.jpg" alt="MistralOCR">
        </div>
      </div>


      
      <!-- 第二排 -->
      <div class="columns is-multiline is-centered">
        <div class="column">
          <img class="fixed-height-img" src="./static/images/img_333_kld_obb.png" alt="Image">
        </div>
        <div class="column">
          <img class="fixed-height-img" src="./static/images/100000645_kld_obb.png" alt="Gemini">
        </div>
        <div class="column">
          <img class="fixed-height-img" src="./static/images/plane_P0963_kld_obb.png" alt="GPT4">
        </div>
        <div class="column">
          <img class="fixed-height-img" src="./static/images/P2032_kld_obb.jpg" alt="MistralOCR">
        </div>
      </div>

      <!-- 第二排 -->
      <div class="columns is-multiline is-centered">
        <div class="column">
          <img class="fixed-height-img" src="./static/images/img_333_probiou_obb.png" alt="Image">
          <h4 class="subtitle has-text-centered">Smooth L1</h4>
        </div>
        <div class="column">
          <img class="fixed-height-img" src="./static/images/100000645_probiou_obb.png" alt="Gemini">
          <h4 class="subtitle has-text-centered">GWD</h4>
        </div>
        <div class="column">
          <img class="fixed-height-img" src="./static/images/plane_P0963_probiou_obb.png" alt="GPT4">
          <h4 class="subtitle has-text-centered">KLD</h4>
        </div>
        <div class="column">
          <img class="fixed-height-img" src="./static/images/P2032_probiou_obb.jpg" alt="MistralOCR">
          <h4 class="subtitle has-text-centered">⭐ ProbIoU (Ours)</h4>
        </div>
      </div>
      
    </div>
  </div>
</section>


<section class="hero teaser">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
          Oriented object detection is a challenging and relatively new problem. Most existing approaches are based on deep learning and explore Oriented Bounding Boxes (OBBs) to represent the objects. They are typically based on adaptations of traditional detectors that work with Horizontal Bounding Boxes (HBBs), which have been exploring IoU-like loss functions to regress the HBBs. However, extending this idea for OBBs is challenging due to complex formulations or requirement for customized backpropagation implementations. Furthermore, using OBBs presents limitations for irregular or roughly circular objects, since the definition of the ideal OBB is an ambiguous and ill-posed problem. In this work, we jointly tackle the problem of training, representing, and evaluating oriented detectors. We explore Gaussian distributions  -- called Gaussian Bounding Boxes (GBBs) -- as fuzzy representations for oriented objects and propose using a similarity metric between two GBBs based on the Hellinger distance. We show that this metric leads to a differentiable closed-form expression that can be directly used as a localization loss term to train OBB object detectors. We also show that GBBs present a natural representation as elliptical regions (called EBBs), which inherently mitigate ambiguity representation for circular objects. Finally, we empirically show that the proposed similarity metric computed between two GBBs strongly correlates with the IoU between the corresponding EBBs, motivating the name Probabilistic Intersection-over-Union (ProbIoU). Our experiments show that results using ProbIoU as a regression loss are competitive with state-of-the-art alternatives without requiring additional hyperparameters or customized implementations, and that ProbIoU is a promising alternative to evaluate oriented object detectors.
          </p>
        </div>
            <div class="publication-image">
            <img src="./static/images/example.jpg" alt="Description of the image">
            </div>
      </div>
    </div>

    
    <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
            <h2 class="title is-3">Approach</h2>
            <div class="content has-text-justified">
            <p>

            <ul>
  <li>
    If we use a fuzzy object representation based on GBBs, we can calculate
    \( B_D \) (distance measure) and present closed-form expressions in terms of
    the GBB parameters.
  </li>

  <li>
    Considering that
    \( p \sim \mathcal{N}(\boldsymbol{\mu}_1, \Sigma_1) \) and
    \( q \sim \mathcal{N}(\boldsymbol{\mu}_2, \Sigma_2) \)
    are Gaussian distributions with
  </li>
</ul>

$$
\boldsymbol{\mu}_1 =
\begin{pmatrix}
x_1 \\ y_1
\end{pmatrix},
\quad
\Sigma_1 =
\begin{bmatrix}
a_1 & c_1 \\
c_1 & b_1
\end{bmatrix},
\quad
\boldsymbol{\mu}_2 =
\begin{pmatrix}
x_2 \\ y_2
\end{pmatrix},
\quad
\Sigma_2 =
\begin{bmatrix}
a_2 & c_2 \\
c_2 & b_2
\end{bmatrix}
$$

<p>we obtain:</p>

$$
B_D =
\frac{1}{8}(\boldsymbol{\mu}_1 - \boldsymbol{\mu}_2)^T
\Sigma^{-1}
(\boldsymbol{\mu}_1 - \boldsymbol{\mu}_2)
+
\frac{1}{2}
\ln\left(
\frac{\det \Sigma}
{\sqrt{\det \Sigma_1 \det \Sigma_2}}
\right),
\quad
\Sigma = \frac{1}{2}(\Sigma_1 + \Sigma_2)
$$

<p>since:</p>

$$
B_C = e^{-B_D},
\quad
H_D(p,q) = \sqrt{1 - B_C(p,q)},
\quad
\text{ProbIoU}(p,q) = 1 - H_D(p,q)
$$

<ul>
  <li>
    \( \text{ProbIoU}(p,q) \) ranges from 0 to 1, with the following properties:
  </li>
</ul>

<br><br><br>

<table>
  <thead>
    <tr>
      <th rowspan="2">Loss</th>
      <th rowspan="2">Implementation</th>
      <th>Scale</th>
      <th>Metric</th>
      <th>Hyper</th>
    </tr>
    <tr>
      <th>Invariance</th>
      <th>Properties</th>
      <th>parameters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>r-IoU</td>
      <td>Hard</td>
      <td>✓</td>
      <td>✓</td>
      <td>--</td>
    </tr>
    <tr>
      <td>Smooth ℓ₁</td>
      <td>Easy</td>
      <td>×</td>
      <td>×</td>
      <td>--</td>
    </tr>
    <tr>
      <td>GWD</td>
      <td>Easy</td>
      <td>×</td>
      <td>×</td>
      <td>τ, f(·)</td>
    </tr>
    <tr>
      <td>KLD</td>
      <td>Easy</td>
      <td>✓</td>
      <td>×</td>
      <td>τ, f(·)</td>
    </tr>
    <tr>
      <td><strong>ProbIoU</strong></td>
      <td>Easy</td>
      <td>✓</td>
      <td>✓</td>
      <td>--</td>
    </tr>
  </tbody>
</table>
            
            </p>
            </div>
            <div class="publication-image">
            <img src="./static/approach.png" alt="Description of the image">
            </div>
        </div>
    </div>

    
  </div>
</section>

<section class="hero is-light is-small">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
            <h2 class="title is-3">Results</h2>
            <div class="content has-text-justified">
            <p>
            We use the MAP metric to compare our method with other SOTA methods.
            </p>
            </div>
            <div class="publication-image">
            <img src="./static/images/8.png" alt="Description of the image">
            </div>
        </div>
    </div>
    
    <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
            <div class="content has-text-justified">
            <p>
            For DOTAv1 we use its evaluation server (only AP50).
            </p>
            </div>
            <div class="publication-image">
            <img src="./static/images/9.png" alt="Description of the image">
            </div>
        </div>
    </div>

    
    <!--/ Paper video. -->
  </div>
</section>

  
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@ARTICLE{10382963,
  author={Murrugarra-Llerena, Jeffri and Kirsten, Lucas N. and Zeni, Luis Felipe and Jung, Claudio R.},
  journal={IEEE Transactions on Image Processing}, 
  title={Probabilistic Intersection-Over-Union for Training and Evaluation of Oriented Object Detectors}, 
  year={2024},
  volume={33},
  number={},
  pages={671-681},
  keywords={Detectors;Location awareness;Object detection;Measurement;Training;Gaussian distribution;Annotations;Computer vision;object detection;performance evaluation},
  doi={10.1109/TIP.2023.3348697}}      
    </code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            We borrow the source code of this website from Nerfies <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a>. Last update: March 2025.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
